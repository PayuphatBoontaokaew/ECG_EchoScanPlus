<!DOCTYPE html>
<html>
<head>
  <title>Heart Rate Monitor</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Heart Rate Monitor</h1>
  <canvas id="heartRateChart" width="800" height="400"></canvas>
  <p><strong>Heart Rate:</strong> <span id="heartRateValue">-</span> BPM</p>
  <p><strong>Total ECG:</strong> <span id="totalEcgValue">-</span> BPM</p>

  <script>
    // WebSocket connection
    const socket = new WebSocket('ws://your-arduino-ip-address:your-arduino-port');

    // Handle WebSocket messages
    socket.onmessage = function (event) {
      const data = JSON.parse(event.data);
      updateHeartRate(data.hr);
      updateTotalEcg(data.totalEcg);
      updateGraph(data.ecgData);
    };

    // Update heart rate value on the page
    function updateHeartRate(heartRate) {
      document.getElementById('heartRateValue').textContent = heartRate;
    }

    // Update total ECG value on the page
    function updateTotalEcg(totalEcg) {
      document.getElementById('totalEcgValue').textContent = totalEcg;
    }

    // Initialize heart rate chart
    const heartRateChart = new Chart('heartRateChart', {
      type: 'line',
      data: {
        labels: [],queueMicrotask
        datasets: [{
          label: 'Heart Rate',
          data: [],
          borderColor: 'rgba(75, 192, 192, 1)',
          borderWidth: 1,
          fill: false,
        }]
      },
      options: {
        scales: {
          x: {
            type: 'linear',
            position: 'bottom',
            title: {
              display: true,
              text: 'Time (seconds)'
            }
          },
          y: {
            min: 0,
            title: {
              display: true,
              text: 'Heart Rate (BPM)'
            }
          }
        }
      }
    });

    // Update the graph with new data
    function updateGraph(ecgData) {
      const time = ecgData.map(data => data.time);
      const heartRateData = ecgData.map(data => data.hr);

      heartRateChart.data.labels = time;
      heartRateChart.data.datasets[0].data = heartRateData;
      heartRateChart.update();
    }
  </script>
</body>
</html>
